@model List<FakeAPI.Models.ApiResponse>  


@{
    ViewData["Title"] = "Listado de Productos";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Listado de Productos</title>


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link href=https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href=" https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/fontawesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>
<body id="body">
    <div class="text-center">
    <h1 class="display-4">Bienvenidos al Listado de Productos</h1>
    </div>
    <div class="container-fluid h-100">
        <div class="row w-100 align-items-center">
            <div class="col text-center">
    <table id="tabla" class="table table-striped">
  <thead>
    <tr>
      <th scope="col">Id#</th>
      <th scope="col">Title</th>
      <th scope="col">Price</th>
      <th scope="col">Description</th>   
      <!---<th scope="col">Id</th>
      <th scope="col">Name</th>
      <th scope="col"> Image</th>
      <th scope="col"> Images</th>-->
      <th scope="col">Editar - Eliminar</th>
    </tr>
  </thead>
  <tbody id="tbody">
   
  </tbody>
</table>
    </div>
   </div>
    </div>

<!-- Modal Agregar Productos -->
<div class="modal fade" id="ModalAgregar"  role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header bg-primary">
            <h4 class="modal-title" id="myModalLabel">Agregar Productos</h4>

            </div>    
            <!-- Modal Body -->
            <div class="modal-body">
                <p class="statusMsg"></p>                                                           
                <form role="form" method="post" id="formulario"  action="">
            
                    <div class="form-group">
                        <label  >Title</label>
                        <input type="text" class="form-control"  name="title" id="title" placeholder="Escribe el nombre del Titulo"/>
                    </div>
                    <div class="form-group">
                        <label >Price</label>
                        <input type="text" class="form-control" name="price" id="price"  placeholder="Escribe el Precio"/>
                    </div>
                    <div class="form-group">
                        <label  >Description</label>
                        <input type="text" class="form-control"  name="description"  id="description" placeholder="Escribe la Descripción"/>
                    </div>
                    <br>
            <!-- Modal Footer -->
            <div class="modal-footer">
            <button type= "submit" class="btn btn-primary submitBtn" id="btn-agregar" name="btn-agregar" data-toggle='modal' onclick="guardarCompleto();alerta();"  >Guardar</button>
                <button type="button" class="btn btn-danger"data-dismiss="modal">Cancelar</button>
            </div>
           
           </form>
            </div>
        </div>
    </div>
</div>

       


    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>

    <link href=https://cdn.datatables.net/1.13.5/css/dataTables.dataTables.min.css />
   
    <script src=https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.2/moment.min.js></script>
   

    <script src=https://code.jquery.com/jquery-3.7.0.js></script>
    <script src=https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js></script>
    <script src=https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.bootstrap5.min.css"/>

    <!-- Mensajes javascripts-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css">




    <script>

        window.onload = function () {
            Obtener();
        };

        function IrFormularioCrear() {
            window.location = "Agregar.html";
        }

         function IrFormularioCrear() {
            window.location = "Editar.html";
        }

//Funcion Obtener Registros y Mostrarlos

        function Obtener() {

            $(".table tbody").html("");

            $.get("https://api.escuelajs.co/api/v1/products")
                .done(function (response) {
                    console.log(response);
                    $.each(response, function (id, fila) {
                        $("<tr>").append(
                            $("<td>").text(fila.id),
                            $("<td>").text(fila.title),
                            $("<td>").text(fila.price),
                            $("<td>").text(fila.description),
                            //$("<td>").text(fila.id),
                            //$("<td>").text(fila.name),
                           // $("<td>").text(fila.image),
                            //$("<td>").text(fila.images),
                            $("<td>").append(
                                $("<button>").data("id", fila.id).addClass("btn btn-success btn-sm mr-1 editar").text("Editar").attr({ "type": "button" }),
                                $("<button>").data("id", fila.id).addClass("btn btn-danger btn-sm eliminar").text("Eliminar").attr({ "type": "button" })
                            )
                        ).appendTo(".table");
                    });
                });
        }

///Editar

        $(document).on('click', '.editar', function () {
            console.log($(this).data("id"));
            window.location = "Editar.html?id=" + $(this).data("id");

        });


        $(document).on('click', '.eliminar', function () {
            console.log($(this).data("id"));

            $.ajax({
                method: "DELETE",
                url: "https://api.escuelajs.co/api/v1/products" + $(this).data("id")
            })
                .done(function (response) {
                    console.log(response);
                    if (response) {
                        Obtener();
                    } else {
                        alert("Error al eliminar")
                    }
                });

        });

      

        const table = new DataTable('#tabla');

        table.on('click', 'tbody tr', (e) => {
            let classList = e.currentTarget.classList;

            if (classList.contains('selected')) {
                classList.remove('selected');
            }
            else {
                table.rows('.selected').nodes().each((row) => row.classList.remove('selected'));
                classList.add('selected');
            }
        });

        document.querySelector('#button').addEventListener('click', function () {
            table.row('.selected').remove().draw(false);
        });


//Funcion Editar

        function editar(id) {
            $.ajax({

                url: "https://api.escuelajs.co/api/v1/products/" + id,
                type: "GET",
                cache: false,
                dataType: 'json',


                success: function (producto) {

                    if (true) {
                        $('#id').val(producto[0].id);
                        $('#title').val(usuario[0].title);
                        $('#precio').val(usuario[0].precio);
                        $('#description').val(usuario[0].description);

                    }

                }




            });


        }

//Modal Agregar

        $('#ModalAgregar').on('shown.bs.modal', function () {
        $('#Input').trigger('focus')
        })
       
</script>

    <footer>
    </footer>
</body>







<!--
* Autora: Maria Margarita Ortiz Vazquez
-->

</html>
